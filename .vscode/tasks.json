{
  "version": "2.0.0",
  "options": {
    "cwd": "${workspaceFolder}",
    "env": {
      "PAWS_SRC_DIR": "${workspaceFolder}/src",
      "PAWS_REPO_DIR": "${workspaceFolder}/../symlinks",
      "PY_INTR": "${command:python.interpreterPath}",
      "PY_INVOKE": "${command:python.interpreterPath} -m invoke",
      "PY_PYLINT": "${command:python.interpreterPath} -m pylint",
      "PY_REPLACE": "${command:python.interpreterPath} ./.vscode/replace_path.py",
      "INVOKE_RUN_ECHO": "true"
    }
  },
  "inputs": [
    {
      "id": "bl_version",
      "type": "pickString",
      "default": "4.5",
      "description": "Blender version",
      "options": ["5.0", "4.5", "4.4", "4.3", "4.2"]
    },
    {
      "id": "bl_factory_startup",
      "type": "pickString",
      "default": "",
      "description": "Run Blender with --factory-startup flag",
      "options": ["", "--factory-startup"]
    },
    {
      "id": "bl_blend_path",
      "type": "pickString",
      "default": "./test_blend/test1.blend",
      "description": ".blend file to open",
      "options": [
        "./test_blend/test1.blend",
        "./src/paws_bakery/assets/materials.blend"
      ]
    }
  ],
  "tasks": [
    {
      "label": "Pylint: lint whole folder",
      "group": {
        "kind": "test"
      },
      "icon": {
        "id": "bracket-error",
        "color": "terminal.ansiGreen"
      },
      "type": "shell",
      "command": "hatch -v run -- pylint --rcfile=pyproject.toml ./src",
      "problemMatcher": [],
      "presentation": {
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "Blender: Extension Build",
      "icon": {
        "id": "archive",
        "color": "terminal.ansiRed"
      },
      "type": "shell",
      "command": "PBKR_BLENDER_VERSION=${input:bl_version} ${PY_INVOKE} build",
      "problemMatcher": [],
      "presentation": {
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "Blender: Extension Install",
      "icon": {
        "id": "git-stash",
        "color": "terminal.ansiYellow"
      },
      "type": "shell",
      "command": "PBKR_BLENDER_VERSION=${input:bl_version} ${PY_INVOKE} install",
      "problemMatcher": [],
      "presentation": {
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "Blender: Launch",
      "icon": {
        "id": "folder-opened",
        "color": "terminal.ansiCyan"
      },
      "runOptions": {
        "instancePolicy": "terminateOldest"
      },
      "type": "shell",
      "command": "PBKR_BLENDER_VERSION=${input:bl_version} ${PY_INVOKE} launch ${input:bl_factory_startup} 2>&1 | ${PY_REPLACE}",
      "problemMatcher": [],
      "presentation": {
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "Blender: Open",
      "icon": {
        "id": "folder-opened",
        "color": "terminal.ansiCyan"
      },
      "runOptions": {
        "instancePolicy": "terminateOldest"
      },
      "type": "shell",
      "command": "PBKR_BLENDER_VERSION=${input:bl_version} ${PY_INVOKE} open ${input:bl_factory_startup} ${input:bl_blend_path} 2>&1 | ${PY_REPLACE}",
      "problemMatcher": [],
      "presentation": {
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "Blender: Test",
      "icon": {
        "id": "folder-opened",
        "color": "terminal.ansiMagenta"
      },
      "runOptions": {
        "instancePolicy": "terminateOldest"
      },
      "type": "shell",
      "command": "PBKR_BLENDER_VERSION=${input:bl_version} ${PY_INVOKE} launch-test && hatch -v run -- pytest ./tests/test_bl/test_regression.py",
      "problemMatcher": [],
      "presentation": {
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "Blender: Build And Test",
      "icon": {
        "id": "folder-opened",
        "color": "terminal.ansiMagenta"
      },
      "runOptions": {
        "instancePolicy": "terminateOldest"
      },
      "dependsOn": [
        "Blender: Extension Build",
        "Blender: Extension Install",
        "Blender: Test"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": [],
      "presentation": {
        "showReuseMessage": false,
        "clear": true
      }
    }
  ]
}
